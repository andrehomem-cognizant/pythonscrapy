Logging output too large. Truncating output. Error parsing JSON response from AppSheet API for table Completed_Cases. Error: Unterminated string in JSON at position 52427305 (line 1 column 52427306). Response text: [{"_RowNumber":"1","Row ID":"rWjhTGs7oX4kA9unrgxN40","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 16:10:05","End Timestamp":"07/09/2025 20:29:06","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"2","Row ID":"J021r6BkCW43QunWp7jMx4","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 20:36:26","End Timestamp":"07/09/2025 20:36:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"3","Row ID":"CMzB2sIhQ74ZahDXmyjBp3","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 20:29:06","End Timestamp":"07/09/2025 20:29:17","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"4","Row ID":"4PDoIxI3aG47yQW78LYDC6","Log ID":"3a3070c0","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Menu Creation","Start Timestamp":"07/09/2025 20:29:17","End Timestamp":"07/09/2025 20:29:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"5","Row ID":"JTWovEu0ku4GYOHbWJtfHc","Log ID":"7a22b306","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Asset Delivery","Start Timestamp":"07/09/2025 20:29:29","End Timestamp":"07/09/2025 20:29:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"07/12/2025 01:14:16","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"6","Row ID":"WjCB_2FzbI4s2mah8xSvz9","Log ID":"9b23abb6","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 10:44:37","End Timestamp":"07/09/2025 10:49:45","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"7","Row ID":"onpcDwTu6N4AILUehAZXrd","Log ID":"6f7f7a0d","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 10:49:53","End Timestamp":"07/09/2025 11:02:14","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"8","Row ID":"pUjmJmQHFH4eAs9zaF60-9","Log ID":"e124cc5b","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 10:49:45","End Timestamp":"07/09/2025 10:50:00","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"9","Row ID":"vc3k0VuxEs4aYhe8vw5wtb","Log ID":"572d8624","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Integration","Start Timestamp":"07/09/2025 10:50:00","End Timestamp":"","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"10","Row ID":"vEt8QD83GO462RXN_JZNaa","Log ID":"c4277da5","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 11:12:34","End Timestamp":"07/09/2025 14:42:24","OBQ Reasons":"","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Photo - Poor Quality","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/14/2025 15:33:57","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7f8a6de5"},{"_RowNumber":"11","Row ID":"5Rht15aKur4sq2m7TS-Wyc","Log ID":"73298cf9","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 14:42:26","End Timestamp":"07/09/2025 14:43:12","OBQ Reasons":"","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Photo - Poor Quality","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/14/2025 15:33:57","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7f8a6de5"},{"_RowNumber":"12","Row ID":"IUf2OhmoUu43iuiDTw0Uqb","Log ID":"8404c6c1","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 14:42:24","End Timestamp":"07/09/2025 14:42:38","OBQ Reasons":"","Case Created":"","Status":"Com

1:29:38 PM	Notice	Execution started
1:29:39 PM	Info	Initial JSON parsing failed. Attempting to fix unescaped quotes. Error: "undefined" is not valid JSON
1:29:38 PM	Error	
TypeError: Cannot read properties of undefined (reading 'length')
_findAndFixUnterminatedJsonString	@ Utilities.gs:121


12:59:29 PM	Notice	Execution started
12:59:30 PM	Info	--- Starting Audit for Case ID: 45051 ---
12:59:30 PM	Info	Step 1: Fetching from AppSheet "Completed_Cases" table...
12:59:51 PM	Info	Logging output too large. Truncating output. Error parsing JSON response from AppSheet API for table Completed_Cases. Error: Unterminated string in JSON at position 52427305 (line 1 column 52427306). Response text: [{"_RowNumber":"1","Row ID":"rWjhTGs7oX4kA9unrgxN40","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 16:10:05","End Timestamp":"07/09/2025 20:29:06","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"2","Row ID":"J021r6BkCW43QunWp7jMx4","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 20:36:26","End Timestamp":"07/09/2025 20:36:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"3","Row ID":"CMzB2sIhQ74ZahDXmyjBp3","Log ID":"d8f55b27","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 20:29:06","End Timestamp":"07/09/2025 20:29:17","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"4","Row ID":"4PDoIxI3aG47yQW78LYDC6","Log ID":"3a3070c0","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Menu Creation","Start Timestamp":"07/09/2025 20:29:17","End Timestamp":"07/09/2025 20:29:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"5","Row ID":"JTWovEu0ku4GYOHbWJtfHc","Log ID":"7a22b306","Date":"7/9/2025","Case ID":"33039","Market":"Poland","User":"johnarvin.javier@cognizant.com","Task type":"Asset Delivery","Start Timestamp":"07/09/2025 20:29:29","End Timestamp":"07/09/2025 20:29:29","OBQ Reasons":"Group Account Creation","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Incorrect Account Info - Basic Information","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"07/12/2025 01:14:16","Asset Trigger Date":"","Onboarding Done":"07/12/2025 01:14:46","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7ee95e43"},{"_RowNumber":"6","Row ID":"WjCB_2FzbI4s2mah8xSvz9","Log ID":"9b23abb6","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 10:44:37","End Timestamp":"07/09/2025 10:49:45","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"7","Row ID":"onpcDwTu6N4AILUehAZXrd","Log ID":"6f7f7a0d","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 10:49:53","End Timestamp":"07/09/2025 11:02:14","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"8","Row ID":"pUjmJmQHFH4eAs9zaF60-9","Log ID":"e124cc5b","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 10:49:45","End Timestamp":"07/09/2025 10:50:00","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"9","Row ID":"vc3k0VuxEs4aYhe8vw5wtb","Log ID":"572d8624","Date":"7/9/2025","Case ID":"33066","Market":"Ukraine","User":"Andrea.Espinocilla@cognizant.com","Task type":"Integration","Start Timestamp":"07/09/2025 10:50:00","End Timestamp":"","OBQ Reasons":"Integration ID Generation , UA Exemptions/Specifics","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/22/2025 14:58:14","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":""},{"_RowNumber":"10","Row ID":"vEt8QD83GO462RXN_JZNaa","Log ID":"c4277da5","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Onboarding Qualify","Start Timestamp":"07/09/2025 11:12:34","End Timestamp":"07/09/2025 14:42:24","OBQ Reasons":"","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Photo - Poor Quality","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/14/2025 15:33:57","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7f8a6de5"},{"_RowNumber":"11","Row ID":"5Rht15aKur4sq2m7TS-Wyc","Log ID":"73298cf9","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Post OBQ","Start Timestamp":"07/09/2025 14:42:26","End Timestamp":"07/09/2025 14:43:12","OBQ Reasons":"","Case Created":"","Status":"Completed","Comments":"","Escalation Reasons":"Photo - Poor Quality","Stored Escalation Duration":"","Stored Paused Duration":"","Asset Delivery Date":"","Asset Trigger Date":"","Onboarding Done":"07/14/2025 15:33:57","Flag Asset Action":"","Flag OnBoarding Done":"","Post OBQ Tags":"","Related Pause Logs":"","Related Escalation Logs":"7f8a6de5"},{"_RowNumber":"12","Row ID":"IUf2OhmoUu43iuiDTw0Uqb","Log ID":"8404c6c1","Date":"7/9/2025","Case ID":"33097","Market":"Slovakia","User":"Andrea.Espinocilla@cognizant.com","Task type":"Admin Creation","Start Timestamp":"07/09/2025 14:42:24","End Timestamp":"07/09/2025 14:42:38","OBQ Reasons":"","Case Created":"","Status":"Com
12:59:51 PM	Info	 -> Found 0 completed task(s) in AppSheet for this case.
12:59:51 PM	Info	
Step 2: Fetching from Google Sheet "Active Cases"...
12:59:52 PM	Info	 -> Found 1 active task(s) in Google Sheets for this case.
12:59:52 PM	Info	    - Task Type: Asset Delivery, Log ID: 34acc136
12:59:52 PM	Info	
Step 3: Reading from the destination Sub_Tasks.csv...
12:59:54 PM	Info	 -> Found 1 task(s) in the final CSV for this case.
12:59:54 PM	Info	    - Task Type: Asset Delivery, Log ID: 34acc136
12:59:54 PM	Info	
Step 4: Analysis...
12:59:54 PM	Info	--- AUDIT FINDINGS: ALL RECORDS ACCOUNTED FOR ---
12:59:54 PM	Info	All tasks for this case seem to be correctly represented in the final CSV file.
12:59:54 PM	Info	--- Audit for Case ID: 45051 Complete ---
12:59:54 PM	Notice	Execution completed






it should be counting cases but if it's filtered based on the task type it will only count the case IDs under those task types. 
 
 
total handled handled under OBQ Task Type - the number of unique case IDs within the date range that has OBQ Task type
Completed cases - case IDs under OBQ Task type with end timestamp wihtin the date range
Inprogress cases - case IDs under OBQ Task type without end timestamp wihtin the date range or end timestamps after the end date
 
Does this make more sense?
 



Hello, I need to adapt my existing Node.js Playwright scraper (hosted on Google Cloud Functions) to perform structured data extraction from restaurant menu pages like Bolt Food.

The goal is to extract a complete, organized list of all menu items and their options, not just the raw HTML.

The scraper must be built to parse the page and find these specific data points for every dish:

Category (e.g., "Burgers", "Drinks")

Dish Name

Price

Description

Image URL

Option Groups (e.g., "Choose Your Size", "Add-ons")

Options (e.g., "Small: $1.00", "Large: $2.00", "Bacon: $1.50")

Here is the required workflow for the Cloud Function:

Scrape and Parse: It must launch Playwright, navigate to the URL, and loop through the page structure to extract all the data points listed above into a structured JSON array.

Format Data: It must convert this final JSON array into a clean CSV-formatted string.

Hash the Content: It must calculate a SHA256 hash of the final CSV string.

Save to Storage: It must save the CSV string as a new file in a Google Cloud Storage bucket. The filename must be the hash (e.g., 5d1a89b....csv).

Generate Link: It must generate a Signed v4 URL for that new file, setting it to expire in 15 minutes.

Return JSON: The function should return a JSON object to my calling app containing the hash, the dishCount, and the temporary signedUrl for the user to download.

Finally, please also provide instructions for setting a Lifecycle Rule on the Cloud Storage bucket to automatically delete all files after 1 day to ensure we do not incur long-term storage costs."
